<!DOCTYPE html>
<html lang="en">

<head>
        <body style="background-color: #ffffff"></body>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>AST_Visualization</title>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style>
		.node circle {
			fill: #07f3df;
			stroke: #000000;
			stroke-width: 1.0px;
		}

		.node text {
			font-size: 5px;
			/* color: rgb(9, 242, 98); */
		}

		.link {
			fill: none;
			stroke: rgb(0, 0, 0);
			stroke-width: 0.3px;
		}
	</style>
</head>

<body>
	<script>
		var width = 2500;
		var height = 2500;
		//区域宽高
		var svg = d3.select('body')
			.append('svg')
			.attr('width', width)
			.attr('height', height)
			.append('g')
			.attr('transform', 'translate(50,0)')
		//树尺寸
		var tree = d3.layout.tree()
			.size([width, height - 2000])

		//对角线
		var diagonal = d3.svg.diagonal()
			.projection(d => [d.y, d.x])
		//请求数据
                
		var root = {"name":"Program",
"children":[
{
"name":"FuncDef",
"children":[
{"name":"Int"},
{"name":"main"},
{"name":"Block",
"children":[
        {"name":"Ident:printf"},


        {"name":"StmtType:returnStmt"},
{"name":"RetVal",
"children":[
{"name":"BType:Int",
"children":[
{"name":"Val:0"}
]},
]}

]}
]},
]}
;
		//获取节点数组和连线数组
		var nodes = tree.nodes(root)//获取所有节点信息
		var links = tree.links(nodes)//获取节点的连线信息集合

		//生成连线
		var link = svg.selectAll('.link')
			.data(links)
			.enter()
			.append('path')
			.attr('class', 'link')
			.attr('d', diagonal)

		//生成节点
		var node = svg.selectAll('.node')
			.data(nodes)
			.enter()
			.append('g')
			.attr('class', 'node')
			.attr('transform', function (d) {
				return "translate(" + d.y + "," + d.x + ")";
			});

		//给节点添加圆圈设置半径 
		node.append('circle')
			.attr('r', 2);


		//给节点添加文本,设置文本样式,位置
		node.append("text")
			.attr("dx", function (d) { return 0; })//定义文本显示x轴偏移量
			.attr("dy", 5)//定义文本显示y轴偏移量
			.style("text-anchor", function (d) { return "middle"; })//文字对齐显示
			.attr('class', 'text')
			.text(function (d) { return d.name; });
	</script>
</body>

</html>
